---
title: "World Happiness Report Analysis"
output: html_document
    theme: flatly
    toc: true
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

# Background 



# Research Questions

I've developed research questions for this project aimed at understanding the relationships between different variables and overall happiness score. 

**Question 1:** Which factors are the strongest predictors of a countryâ€™s happiness score?

**Question 2:** How well do health indicators predict happiness scores compared to economic indicators? 

**Question 3:** How is public health expenditure associate with happiness score across countries and years?

**Question 4:** Do countries with higher public health expenditure also show higher healthy life expectancy?

# Loading Necessary Packages 

```{r}
library(tidyverse)
library(ggcorrplot)
library(broom)
library(lubridate)
```

# Importing data

I downloaded the data for this project from [Kaggle](https://www.kaggle.com/datasets/khushikyad001/world-happiness-report/data). I'll use the `read.csv` function to import it. 

```{r}
globalhealth <- read.csv(file = "globalhealth.csv",
                    header = TRUE,
                    stringsAsFactors = FALSE)
```

Data Structure and Variables

I'll use the `glimpse` function to take a look at the data. 

```{r}
glimpse(globalhealth)
```

The `worldhappiness` dataframe contains 24 variables (columns) and 4000 observations (rows), with the rows representing different countries across different years. 

The 24 variables are: 

1. Country: Name of the country.

2. Year: The year of the record.

3. Happiness_Score: A numerical value indicating the happiness level.

4. GDP_per_Capita: Economic output per person.

5. Social_Support: Level of social connections and support.

6. Healthy_Life_Expectancy: Average life expectancy with good health.

7. Freedom: Perceived freedom in decision-making.

8. Generosity: A measure of charitable behavior.

9. Corruption_Perception: Perception of corruption in society.

10. Unemployment_Rate: Percentage of unemployed individuals.

11. Education_Index: A measure of education quality.

12. Population: Total population of the country.

13. Urbanization_Rate: Percentage of people living in urban areas.

14. Life_Satisfaction: A subjective measure of well-being.

15. Public_Trust: Confidence in public institutions.

16. Mental_Health_Index: A measure of overall mental health.

17. Income_Inequality: Economic disparity metric.

18. Public_Health_Expenditure: Government spending on health.

19. Climate_Index: A measure of climate conditions.

20. Work_Life_Balance: An index measuring work-life balance.

21. Internet_Access: Percentage of population with internet.

22. Crime_Rate: Reported crime level.

23. Political_Stability: A measure of political security.

24. Employment_Rate: Percentage of employed individuals.

```{r}
globalhealth_2024 <- globalhealth %>%
  filter(Year == 2024, Disease.Name == "Malaria")

glimpse(globalhealth_2024)

bad_cols <- c("Year", "Disease.Name")

globalhealth_2024_clean <- globalhealth_2024 %>%
  select(-all_of(bad_cols))

globalhealth_2024_clean <- globalhealth_2024_clean %>%
  mutate(across(where(is.character), as.factor))

gh_model <- lm(`Prevalence.Rate....` ~ Doctors.per.1000, data = globalhealth_2024_clean)


summary(gh_model)
```

```{r}
plot(gh_model, which=1)
```

```{r}
sleephealth <- read.csv(file = "sleep.csv",
                    header = TRUE,
                    stringsAsFactors = FALSE)

glimpse(sleephealth)

sleepmodel <- lm(`Sleep.Duration` ~., data = sleephealth)
summary(sleepmodel)

```

